<div class="flex min-h-screen layout-wrapper">
  <!-- Overlay สำหรับ mobile เมื่อเปิด sidebar -->
  <div
    *ngIf="sidebarOpen"
    class="fixed inset-0 z-30 bg-black bg-opacity-50 lg:hidden"
    (click)="toggleSidebar()"
  ></div>

  <!-- Mobile Menu Button -->
  <button
    class="fixed z-50 p-2 text-white bg-purple-600 rounded-lg shadow-lg top-4 left-4 lg:hidden"
    (click)="toggleSidebar()"
  >
    <i class="text-xl pi pi-bars"></i>
  </button>

  <!-- Sidebar with responsive behavior -->
  <div
    [ngClass]="{
      'translate-x-0': sidebarOpen,
      '-translate-x-full': !sidebarOpen
    }"
    class="fixed top-0 left-0 z-40 flex flex-col justify-between w-64 h-screen overflow-y-auto transition-transform duration-300 bg-white shadow-lg layout-sidebar lg:sticky lg:translate-x-0"
  >
    <!-- ส่วนบน: Logo + Menu -->
    <div>
      <!-- Logo Section -->
      <div
        class="flex flex-col items-center justify-center py-4 sm:py-6 bg-gradient-to-b from-[#EDE9FE] to-[#D8B4FE] text-[#5D3B80] rounded-lg shadow-lg transition-all duration-300 transform hover:-translate-y-1 mx-2 mt-2"
      >
        <div class="relative p-2 bg-white rounded-full shadow-md">
          <img
            src="https://i.ibb.co/1B4DWZ8/icon.png"
            alt="Logo"
            class="object-cover w-16 h-16 rounded-full sm:w-20 sm:h-20"
          />
        </div>
        <div class="px-2 mt-2 text-lg font-semibold text-center sm:mt-3 sm:text-xl">AR Internship</div>
        <div class="flex items-center gap-2 px-2 mt-2 sm:gap-3 sm:mt-3">
          <div
            class="flex items-center justify-center w-8 h-8 transition-all duration-300 transform bg-blue-500 rounded-full shadow-md sm:w-10 sm:h-10 hover:-translate-y-1"
          >
            <i class="text-sm text-white pi pi-user sm:text-base"></i>
          </div>
          <div class="min-w-0">
            <p class="text-sm font-semibold text-blue-900 truncate sm:text-base">
              {{ currentUser?.fullname }}
            </p>
            <p class="text-xs text-blue-700 sm:text-sm">
              สิทธิ์:
              <span
                [class]="
                  isAdmin
                    ? 'text-red-600 font-bold'
                    : 'text-green-600 font-bold'
                "
              >
                {{ isAdmin ? "Admin (ผู้ดูแลระบบ)" : "User (ผู้ใช้งานทั่วไป)" }}
              </span>
            </p>
          </div>
        </div>
      </div>

      <!-- Menu Items -->
      <ul class="flex flex-col gap-1 px-2 mt-4 layout-menu">
        <li *ngFor="let item of sidebarItems">
          <!-- Main Menu Item without Submenu -->
          <a
            *ngIf="!item.submenu"
            [routerLink]="item.routerLink"
            (click)="sidebarOpen && toggleSidebar()"
            class="layout-menuitem-link flex items-center gap-3 px-3 sm:px-4 py-2 rounded transition-all duration-300 transform hover:-translate-y-1 hover:shadow-md hover:bg-[#E0F2FE] hover:text-[#1E3A8A] font-medium cursor-pointer text-sm sm:text-base"
          >
            <i [class]="item.icon"></i>
            <span class="menu-label">{{ item.label | translate }}</span>
          </a>

          <!-- Menu with Submenu -->
          <div *ngIf="item.submenu">
            <div
              (click)="toggleSubmenu(item)"
              class="layout-menuitem-link flex items-center justify-between gap-3 px-3 sm:px-4 py-2 rounded transition-all duration-300 transform hover:-translate-y-1 hover:shadow-md hover:bg-[#E0F2FE] hover:text-[#1E3A8A] font-medium cursor-pointer text-sm sm:text-base"
            >
              <div class="flex items-center gap-3">
                <i [class]="item.icon"></i>
                <span class="menu-label">{{ item.label | translate }}</span>
              </div>
              <i
                [class]="item.expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
                class="text-sm transition-transform duration-300"
              ></i>
            </div>

            <!-- Submenu -->
            <ul
              *ngIf="item.expanded"
              [@slideDown]
              class="flex flex-col gap-1 mt-1 ml-4 transition-all duration-300 ease-in-out submenu"
            >
              <li *ngFor="let subitem of item.submenu">
                <a
                  [routerLink]="subitem.routerLink"
                  (click)="sidebarOpen && toggleSidebar()"
                  class="flex items-center gap-3 px-3 sm:px-4 py-2 rounded text-xs sm:text-sm transition-all duration-200 hover:bg-[#DBEAFE] hover:text-[#1E40AF] hover:translate-x-1 cursor-pointer"
                >
                  <i [class]="subitem.icon" class="text-xs"></i>
                  <span>{{ subitem.label | translate }}</span>
                </a>
              </li>
            </ul>
          </div>
        </li>
      </ul>
    </div>

    <!-- ส่วนล่าง: Logout Button -->
    <div class="px-4 pb-4">
      <button
        (click)="logout()"
        class="flex items-center justify-center w-full gap-2 px-3 py-2 text-sm font-semibold text-red-500 transition-all duration-200 transform border-2 border-blue-300 rounded shadow-lg sm:px-4 bg-primary hover:bg-secondary hover:shadow-2xl hover:-translate-y-1 sm:text-base"
      >
        <i class="pi pi-sign-out"></i>
        Logout
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex flex-col flex-1 min-w-0 layout-main bg-background">
    <!-- Topbar / Menubar -->
    <div
      class="flex items-center justify-end p-3 transition-all duration-300 transform bg-white border-none sm:p-4 menubar-header hover:-translate-y-1 mt-14 lg:mt-0"
    >
    </div>

    <!-- Router Outlet + Footer -->
    <div
      class="flex-1 p-3 mx-2 mt-3 overflow-auto transition-all duration-300 transform rounded-lg shadow-lg sm:p-4 sm:mx-4 bg-background hover:-translate-y-1"
    >
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
